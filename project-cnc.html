<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom CNC Machine | Brason Young</title>
    <link rel="stylesheet" href="styles.css">
    <script src="script.js" defer></script>
</head>
<body>
<header class="site-header">
    <div class="container header-inner">
        <div class="logo">
            <a href="index.html">BY</a>
        </div>
        <nav class="nav">
            <a href="index.html" class="nav-link">Home</a>
            <a href="projects.html" class="nav-link active">Projects</a>
            <a href="experience.html" class="nav-link">Experience</a>
            <a href="about.html" class="nav-link">About</a>
        </nav>
    </div>
</header>

<main>
    <section class="section">
        <div class="container">
            <a href="projects.html" class="text-link">← Back to Projects</a>

            <header class="project-detail-header">
                <div>
                    <h1 class="page-title">Custom Designed CNC Machine</h1>
                    <p class="section-subtitle">
                        From concept to a fully functional CNC machine: CAD design, fabrication, wiring, and G-code programming.
                    </p>
                </div>
            </header>

            <div class="project-detail-body">
                <div class="project-detail-text">
                    <h2>Overview</h2>
                    <p>
                        This project started as a simple idea: build my own CNC machine from scratch and learn every part
                        of the process. I used Fusion 360 to design the full machine, including the frame, motion components,
                        and mounting features for motors and electronics. After finalizing the design, I fabricated the
                        parts myself and assembled the complete machine.
                    </p>
                    <p>
                        Once the mechanical build was complete, I wired the stepper motors, drivers, power supply, and
                        control electronics. I configured the controller, set up homing and limits, and learned G-code to
                        create and run toolpaths. The machine is now capable of cutting parts to a high degree of accuracy
                        and repeatability.
                    </p>

                    <h2>My Role &amp; Responsibilities</h2>
                    <ul class="project-meta-list">
                        <li>Concept development and requirements (work envelope, rigidity, materials).</li>
                        <li>Full 3D CAD design in Fusion 360, including assemblies and key dimensions.</li>
                        <li>Fabrication and assembly of mechanical components (frame, gantry, mounting plates, etc.).</li>
                        <li>Wiring of stepper motors, drivers, power supply, and control electronics.</li>
                        <li>Controller configuration, basic tuning, and G-code programming for test cuts.</li>
                    </ul>

                    <h2>Key Skills &amp; Tools</h2>
                    <ul class="project-meta-list">
                        <li>Fusion 360 – CAD modeling and design validation.</li>
                        <li>Mechanical fabrication – cutting, drilling, tapping, and assembly.</li>
                        <li>Electronics – stepper motors, drivers, wiring, and grounding.</li>
                        <li>CNC concepts – work offsets, feeds/speeds, toolpaths, homing/limits.</li>
                        <li>G-code – writing and editing simple programs to run parts.</li>
                    </ul>
                </div>

                <div class="project-detail-side">
                    <h2>Photos</h2>
                    <p class="section-subtitle">
                        A few views of the machine from design to final assembly.
                    </p>
                    <div class="project-gallery">
                        <!-- Replace these with your real file names -->
                        <img src="cnc1.jpg" alt="CNC machine full view">
                        <img src="cnc2.jpg" alt="Fusion 360 model of CNC machine">
                        <img src="cnc3.jpg" alt="Close-up of CNC gantry and linear rails">
                        <img src="cnc4.jpg" alt="Electronics wiring and control box">
                        <img src="cnc5.jpg" alt="CNC machine cutting a test part">
                    </div>
                    <p class="gallery-note">
                        Click any image to open it in a new tab for a closer look.
                    </p>

                    <h2>3D Model Preview</h2>
                    <p class="section-subtitle">
                        Explore a simplified 3MF of the CNC frame. Rotate and zoom to inspect details.
                    </p>
                    <div id="cnc-three-viewer" class="stl-viewer" data-model="cnc.3mf">
                        <div class="stl-viewer__fallback">
                            Loading interactive preview...
                        </div>
                    </div>
                    <p class="gallery-note">
                        If the viewer doesn't load, make sure your 3MF file is saved at <code>models/cnc-machine.3mf</code>.
                    </p>
                </div>
            </div>

        </div>
    </section>
</main>

<footer class="site-footer">
    <div class="container footer-inner">
        <p>© <span id="year"></span> Brason Young. All rights reserved.</p>
        <div class="footer-links">
            <a href="mailto:brason.young04@gmail.com">Email</a>
            <a href="https://github.com/brasonyoung" target="_blank" rel="noopener">GitHub</a>
            <a href="https://www.linkedin.com/in/brasonyoung" target="_blank" rel="noopener">LinkedIn</a>
        </div>
    </div>
</footer>

<script src="https://unpkg.com/three@0.159.0/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.159.0/examples/js/controls/OrbitControls.js"></script>
<script src="https://unpkg.com/three@0.159.0/examples/js/loaders/3MFLoader.js"></script>
<script>
    function initGalleryLightbox() {
        document.querySelectorAll('.project-gallery img').forEach(img => {
            img.addEventListener('click', () => {
                window.open(img.src, '_blank');
            });
        });
    }

    function initCncViewer() {
        const container = document.getElementById('cnc-three-viewer');
        if (!container || typeof THREE === 'undefined') return;

        const fallback = container.querySelector('.stl-viewer__fallback');

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setPixelRatio(Math.min(window.devicePixelRatio || 1, 2));
        renderer.setSize(container.clientWidth, container.clientHeight);
        renderer.setClearColor(0x000000, 0);
        container.appendChild(renderer.domElement);

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(
            45,
            container.clientWidth / container.clientHeight || 1,
            0.1,
            2000
        );
        camera.position.set(200, 160, 200);

        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.08;
        controls.target.set(0, 0, 0);

        const hemiLight = new THREE.HemisphereLight(0xffffff, 0x1a1a2e, 1.1);
        scene.add(hemiLight);
        const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
        dirLight.position.set(160, 220, 120);
        scene.add(dirLight);

        const loader = new THREE.ThreeMFLoader();
        const modelSrc = container.dataset.model || 'cnc.3mf';
        loader.load(
            modelSrc,
            (object) => {
                object.traverse(child => {
                    if (child.isMesh) {
                        child.castShadow = true;
                        child.receiveShadow = true;
                        if (!child.material || child.material.color.equals(new THREE.Color(0x000000))) {
                            child.material = new THREE.MeshStandardMaterial({ color: 0x9ca3af, metalness: 0.1, roughness: 0.6 });
                        }
                    }
                });

                const box = new THREE.Box3().setFromObject(object);
                const center = box.getCenter(new THREE.Vector3());
                object.position.sub(center);

                const size = box.getSize(new THREE.Vector3());
                const maxDim = Math.max(size.x, size.y, size.z) || 100;
                const distance = maxDim * 2.2;
                camera.position.set(distance, distance, distance);
                controls.target.set(0, 0, 0);
                controls.update();

                scene.add(object);

                if (fallback) {
                    fallback.style.display = 'none';
                }
            },
            undefined,
            (error) => {
                if (fallback) {
                    fallback.innerHTML = `3D preview unavailable. <a href="${modelSrc}" target="_blank" rel="noopener">Download the model</a> instead.`;
                    fallback.style.display = 'flex';
                }
                console.error('Failed to load 3MF model', error);
            }
        );

        function onResize() {
            const width = container.clientWidth;
            const height = container.clientHeight;
            if (!width || !height) return;
            camera.aspect = width / height;
            camera.updateProjectionMatrix();
            renderer.setSize(width, height);
        }

        window.addEventListener('resize', onResize);

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }

        animate();
    }

    document.addEventListener('DOMContentLoaded', () => {
        initGalleryLightbox();
        initCncViewer();
    });
</script>
</body>
</html>
